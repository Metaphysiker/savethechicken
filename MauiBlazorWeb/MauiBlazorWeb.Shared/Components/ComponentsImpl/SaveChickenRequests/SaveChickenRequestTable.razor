@inject IJSRuntime JS
@using MudBlazor
@using MudBlazor.Components
@using global::Shared.Dtos.DtosImpl
@code {
    [Parameter]
    public List<SaveChickenRequestDto> items { get; set; } = new List<SaveChickenRequestDto>();

    [Parameter] public EventCallback<SaveChickenRequestDto> OnItemSelected { get; set; }
    void SelectItem(SaveChickenRequestDto item) => OnItemSelected.InvokeAsync(item);

    [Parameter] public EventCallback<(string? SortBy, bool? SortDescending)> OnSortSelected { get; set; }
    void SortByColumn(string columnName, bool? descending) => OnSortSelected.InvokeAsync((columnName, descending));

    private string? currentColumnName = null;
    private bool? currentSortDescending = null;

    private void OnHeaderClick(string columnName)
    {
        //write to console
        JS.InvokeVoidAsync("console.log", $"Sorting by column: {columnName}");
        bool? descending = currentColumnName == columnName ? !currentSortDescending : false;
        currentColumnName = columnName;
        currentSortDescending = descending;
        SortByColumn(columnName, descending);
    }

    private SaveChickenRequestDto? selectedItem;
}


<MudDataGrid Items="@items" Hover="true" Dense="true" Striped="true" Bordered="true">
    <Columns>
        <PropertyColumn Property="x => x.Id" Title="Id" />
        <PropertyColumn Property="x => x.CreatedAt" Title="Created At" />
        <PropertyColumn Property="x => x.UpdatedAt" Title="Updated At" />
        <PropertyColumn Property="x => x.Contact.FirstName" Title="First Name" />
        <PropertyColumn Property="x => x.Contact.LastName" Title="Last Name" />
        <PropertyColumn Property="x => x.Address.Street" Title="Street" />
        <PropertyColumn Property="x => x.Address.City" Title="City" />
        <PropertyColumn Property="x => x.Address.PostalCode" Title="Postal Code" />
        <PropertyColumn Property="x => x.Contact.PhoneNumber" Title="Phone Number" />
        <PropertyColumn Property="x => x.Contact.Email" Title="Email" />
        <PropertyColumn Property="x => x.NumberOfChickensToBeSaved" Title="Number Of Chickens" />
        <PropertyColumn Property="x => x.DescriptionOfPlaceForChickens" Title="Description Of Place" />
        <PropertyColumn Property="x => x.AcceptTermsAndConditions" Title="Accepted Terms" />
        <PropertyColumn Property="x => x.Message" Title="Message" />
        <PropertyColumn Property="x => x.SaveChickenActionId" Title="SaveChickenActionId" />
        <PropertyColumn Property="x => x.Id" Title="Select">
            <CellTemplate Context="context">
                <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@(() => SelectItem(context))">Select</MudButton>
            </CellTemplate>
        </PropertyColumn>
    </Columns>
</MudDataGrid>

